# API Документация

## Базовый URL
Все API эндпоинты доступны по базовому адресу `/api`

## Аутентификация
Большинство эндпоинтов требуют аутентификации через токен пользователя и его id.
Отправлять данные следует в таком формате.
```json
{
  "user_token": "string",
  "user_id": "integer"
}
```

## Эндпоинты

### Получение токена авторизации
```python
GET /api/auth
```
Создает нового пользователя и кластер, возвращает токены для доступа.

**Rate Limit:** 1 запрос в минуту

**Ответ:**
```json
{
  "user_token": "string",
  "user_id": "integer", 
  "cluster_token": "string"
}
```

### Получение информации об аккаунте
```python
POST /api/info
```
Возвращает полную информацию о пользователе, кластере, чатах и сообщениях.

**Требует аутентификации**

**Rate Limit:** 60 запросов в минуту

**Ответ:**
```json
{
  "user_id": "integer",
  "cluster_token": "string",
  "chats": {
    "chat_id": {
      "name": "string",
      "ready": "boolean",
      "messages": [
        {
          "user_sent": "integer",
          "text": "string", 
          "time": "timestamp"
        }
      ]
    }
  },
  "users": [
    {
      "user_id": "integer",
      "about": "string"
    }
  ]
}
```

### Присоединение к кластеру
```python
POST /api/join_cluster
```
Позволяет пользователю присоединиться к существующему кластеру по токену.

**Требует аутентификации**

**Rate Limit:** 60 запросов в минуту

**Тело запроса:**
```json
{
  "cluster_token": "string"
}
```
### Создание чата
```python
POST /api/create_chat
```
Создает новый чат в кластере пользователя.

**Требует аутентификации**

**Rate Limit:** 60 запросов в минуту

**Тело запроса:**
```json
{
  "name": "string"
}
```

### Изменение названия чата
```python
POST /api/edit_chat_name
```
Изменяет название существующего чата.

**Требует аутентификации**

**Rate Limit:** 60 запросов в минуту

**Тело запроса:**
```json
{
  "chat_id": "integer",
  "name": "string"
}
```

### Удаление чата
```python
POST /api/delete_chat
```
Удаляет чат из кластера.

**Требует аутентификации**

**Rate Limit:** 60 запросов в минуту

**Тело запроса:**
```json
{
  "chat_id": "integer"
}
```

### Отправка сообщения
```python
POST /api/send_message
```
Отправляет сообщение в чат и запускает AI-обработку.

**Требует аутентификации**

**Rate Limit:** 60 запросов в минуту

**Тело запроса:**
```json
{
  "chat_id": "integer",
  "text": "string"
}
```

### Получение списка заданий
```python
POST /api/get_tasks
```
Возвращает список активных заданий для пользователя.

**Требует аутентификации**

**Rate Limit:** 60 запросов в минуту

**Ответ:**
```json
[
  {
    "timestamp": "datetime",
    "text": "string",
    "id": "integer"
  }
]
```

### Завершение задания
```python
POST /api/complete_task
```
Отмечает задание как выполненное и возвращает результат.

**Требует аутентификации**

**Rate Limit:** 60 запросов в минуту

**Тело запроса:**
```json
{
  "event_id": "integer",
  "text": "string"
}
```